---
title: "RWorksheet_Hallares#4b"
author: "Marc Christian P. Hallares"
date: "2025-11-17"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
````

# 1. Using the for loop, create an R script that will display a 5x5 matrix as shown in Figure 1. It must contain vectorA = [1,2,3,4,5] and a 5 x 5 zero matrix.

# Create a 5×5 Matrix Using For Loop

```{r}
vectorA <- 1:5
matrix_result <- matrix(0, nrow = 5, ncol = 5)

for (i in 1:5) {
  for (j in 1:5) {
    matrix_result[i, j] <- abs(i - j)
  }
}

matrix_result
```

---

# 2. Print the string "*" using for() function. The output should be the same as shown in Figure

# Print a Star Pattern Using Nested For Loops

```{r}
for (i in 1:5) {
  for (j in 1:i) {
    cat('"*"\t')
  }
  cat("\n\n")
}
```

---

# 3. Get an input from the user to print the Fibonacci sequence starting from the 1st input up to 500. Use repeat and break statements. Write the R Scripts and its output. 

# Fibonacci Sequence Using `repeat` and `break`

```{r}
fib_sequence <- function() {
  start <- as.integer(readline(prompt = "Enter starting number: "))

  if (start <= 0) {
    print("Please enter a positive number")
    return()
  }

  a <- 0
  b <- 1
  count <- 0
  result <- c()

  repeat {
    if (count >= start) {
      if (b > 500) break
      result <- c(result, b)
    }

    temp <- a + b
    a <- b
    b <- temp
    count <- count + 1
  }

  print(result)
}
```

---

# 4. Import the dataset as shown in Figure 1 you have created previously.

## a. Import and Display First 6 Rows

```{r}
library(readxl)

data <- read_excel("import_march.xlsx")
head(data)
```

## b. Subset by Gender and Count Observations

```{r}
male_data <- subset(data, Students == "Male")
female_data <- subset(data, Students == "Female")

cat("Number of Male observations:", nrow(male_data), "\n")
cat("Number of Female observations:", nrow(female_data), "\n")
```

## c. Barplot of Male and Female Counts

```{r}
gender_counts <- table(data$Students)

barplot(
  gender_counts,
  main = "Number of Male and Female Observations",
  xlab = "Gender",
  ylab = "Count",
  col = c("pink", "lightblue"),
  legend.text = TRUE,
  args.legend = list(x = "topright", legend = c("Female", "Male"))
)
```

---

# 5. Pie Chart of Monthly Expense Distribution

```{r}
expenses <- c(60, 10, 5, 25)
categories <- c("Food", "Electricity", "Savings", "Miscellaneous")

percent <- round(expenses / sum(expenses) * 100)
labels <- paste(categories, percent, "%")

pie(
  expenses,
  labels = labels,
  col = c("orange", "skyblue", "lightgreen", "pink"),
  main = "Monthly Income Distribution of Dela Cruz Family"
)
```

---

# 6. Iris Dataset

## a. Structure of Dataset

```{r}
data(iris)
str(iris)
```

## b. Mean of Numerical Variables

```{r}
iris_means <- data.frame(
  Sepal.Length = mean(iris$Sepal.Length),
  Sepal.Width  = mean(iris$Sepal.Width),
  Petal.Length = mean(iris$Petal.Length),
  Petal.Width  = mean(iris$Petal.Width)
)

iris_means
```

## c. Pie Chart of Species Distribution

```{r}
species_counts <- table(iris$Species)

pie(
  species_counts,
  main = "Iris Species Distribution",
  col = c("red", "blue", "green"),
  labels = paste(names(species_counts), species_counts)
)
```

## d. Subset Each Species (Last 6 Rows)

```{r}
setosa     <- iris[iris$Species == "setosa", ]
versicolor <- iris[iris$Species == "versicolor", ]
virginica  <- iris[iris$Species == "virginica", ]

tail(setosa, 6)
tail(versicolor, 6)
tail(virginica, 6)
```

## e. Scatterplot of Sepal Length vs Width

```{r}
plot(
  iris$Sepal.Length, iris$Sepal.Width,
  main = "Iris Dataset",
  sub  = "Sepal Width and Length",
  xlab = "Sepal Length",
  ylab = "Sepal Width",
  pch = c(16, 17, 18)[as.numeric(iris$Species)],
  col = c("red", "blue", "green")[as.numeric(iris$Species)]
)

legend(
  "topright",
  legend = levels(iris$Species),
  pch = c(16, 17, 18),
  col = c("red", "blue", "green")
)
```

## f. Interpretation

```{r}
"The scatterplot shows clear species separation. Setosa has short, wide sepals, forming a distinct cluster. Versicolor and Virginica overlap more, though Virginica generally has longer sepals. This shows that species differ in sepal measurements, with Setosa being the most easily distinguishable."
```

---

# 7. Alexa Variants Dataset

## a. Clean Variation Names Using `gsub()`

```{r}
library(readxl)
library(dplyr)

alexa <- read_xlsx("alexa-file.xlsx")

alexa$variation <- gsub("Black  Dot",  "Black Dot",  alexa$variation)
alexa$variation <- gsub("Black  Plus", "Black Plus", alexa$variation)
alexa$variation <- gsub("Black  Show", "Black Show", alexa$variation)
alexa$variation <- gsub("Black  Spot", "Black Spot", alexa$variation)
alexa$variation <- gsub("White  Dot",  "White Dot",  alexa$variation)
alexa$variation <- gsub("White  Plus", "White Plus", alexa$variation)
alexa$variation <- gsub("White  Show", "White Show", alexa$variation)
alexa$variation <- gsub("White  Spot", "White Spot", alexa$variation)

head(alexa, 10)
```

## b. Count Variations and Save as RData

```{r}
variations <- alexa %>% count(variation)
variations

save(variations, file = "variations.RData")
```

## c. Barplot of All Variations

```{r}
barplot(
  variations$n,
  names.arg = variations$variation,
  main = "Total Number of Alexa Variations",
  xlab = "Variation",
  ylab = "Count",
  col = rainbow(nrow(variations)),
  las = 2,
  cex.names = 0.7
)
```

## d. Black and White Variations — Side-by-Side Barplots

```{r}
black_vars <- variations[grepl("Black", variations$variation), ]
white_vars <- variations[grepl("White", variations$variation), ]

par(mfrow = c(1, 2))

barplot(
  black_vars$n,
  names.arg = black_vars$variation,
  main = "Black Variations",
  xlab = "Variation",
  ylab = "Count",
  col = "black",
  las = 2,
  cex.names = 0.8
)

barplot(
  white_vars$n,
  names.arg = white_vars$variation,
  main = "White Variations",
  xlab = "Variation",
  ylab = "Count",
  col = "lightgray",
  las = 2,
  cex.names = 0.8
)

par(mfrow = c(1, 1))
```

---



